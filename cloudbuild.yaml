steps:
# Build the Node.js application
- name: "node:20-alpine"
  entrypoint: "sh"
  args: ["-c", "npm install && npm run build"]
  dir: "/workspace"
  
# Build the Nginx image and copy the built files
- name: "gcr.io/cloud-builders/docker"
  args: ["build", "-t", "gcr.io/$kevinoli-portfolio/portfolio", "."]
  dir: "/workspace"
  
# Push the Nginx image to Google Container Registry
- name: "gcr.io/cloud-builders/docker"
  args: ["push", "gcr.io/$kevinoli-portfolio/portfolio"]
  
# Deploy to Google Cloud Run
- name: "gcr.io/cloud-builders/gcloud"
  args: ["run", "deploy", "my-app", "--image", "gcr.io/$kevinoli-portfolio/portfolio", "--platform", "managed", "--region", "us-west4"]
